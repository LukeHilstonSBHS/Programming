<!doctype html>

<head>
    <meta charset="utf-8">
    <title>FALL</title>
</head>


<body>
    <div id="game">
        <div id="character"></div>
    </div>
    <canvas id="gameCanvas" width="800" height="800"></canvas>
    <style>
        canvas {
            display: block;
            margin: auto;
        }

    </style>
    <script>
        var canvas, canvasContext;

        window.onload = function() {
            canvas = document.getElementById('gameCanvas');
            canvasContext = canvas.getContext('2d');

            document.addEventListener('keydown', keyPressed);
            document.addEventListener('keyup', keyReleased);

            setInterval(mainloop, 1000 / 50);
        }



        // player vars
        var playerXpos = 0;
        var playerYpos = 100;
        var playersize = 20;
        var playerXspeed = 10;
        var playerYspeed = 5;
        
        var platformXpos = 50;
        var platformYpos = 450;
        var platformHeight = 20;
        var platformWidth = 200;
        var platformYspeed = 3;
        
        const LEFT_KEY = 37;
        const RIGHT_KEY = 39;
        var leftKeyPressed = false;
        var rightKeyPressed = false;
        
        var platforms = [];

        function mainloop() {
            colorRect(0, 0, canvas.width, canvas.height, 'black');
            colorRect(playerXpos, playerYpos, playersize, playersize, 'red');
            colorRect(platformXpos, platformYpos, platformWidth, platformHeight, 'white');
            
            playerMove();
            platformMove();
            collision();
        }

        function keyPressed(evt) {

            if (evt.keyCode == LEFT_KEY) { 
                leftKeyPressed = true;  
            }
            if (evt.keyCode == RIGHT_KEY) { 
                rightKeyPressed = true;  
            }

        }
        
        function keyReleased(evt) {

            if (evt.keyCode == LEFT_KEY) { 
                leftKeyPressed = false;  
            }
            if (evt.keyCode == RIGHT_KEY) { 
                rightKeyPressed = false;  
            }

        }
        var hit = false;
        
        function collision(){
            if(playerXpos + playersize > platformXpos && playerXpos < platformXpos + platformWidth && 
              playerYpos + playersize > platformYpos && playerYpos < platformYpos + platformHeight){
                playerYpos -= platformYspeed;
                hit = true;
            } else {
                hit = false;
            }
        }


        function playerMove() {
            if(hit == false){
                playerYpos += playerYspeed; 
            }
            
            
            if(leftKeyPressed && playerXpos > 0){ 
                playerXpos -= playerXspeed
            }
            if(rightKeyPressed && playerXpos + playersize < canvas.width){ 
                playerXpos += playerXspeed
            }
    
            
        }
        
        
//        function moveBalls(){
//            balls.forEach(function(ball,i){
//                ball.ballXpos += ball.ballXspeed;
//                
//                
//                //right edge bounce
//                if(ball.ballXpos + ball.ballSize > canvas.width){
//                    ball.ballXspeed *= -1;
//                }
//                if(ballXpos < 0){
//                    ball.ballXspeed *= -1;
//                }
//                
//                if(ball.ballYpos > canvas.height){
//                    ball.ballYpos = 0 - ball.ballSize;
//                    ball.ballSize = math.floor(math.random()*(100 - 10)) + 10;
//                     ball.ballXspeed = math.floor(math.random()*(20 - 2)) + 2;
//                     ball.ballYspeed = math.floor(math.random()*(20 - 2)) + 2;
//                }
//                   
//            })
//                          
//        }
        
        function platformMove(){
            platformYpos -= platformYspeed
        }

        function colorRect(x, y, w, h, c) {
            canvasContext.fillStyle = c;
            canvasContext.fillRect(x, y, w, h);
        }

    </script>
</body>
